


.. toctree::
   :maxdepth: 2
   :caption: Contents:

Содержание 
==================
* `Главная страница`_.

.. _`Главная страница`: /home/dmitrii/Elvoucher/docs/_build/html/elvoucher.html

* `Основная информация о системе`_.

.. _`Основная информация о системе`: /home/dmitrii/Elvoucher/docs/_build/html/main.html

* `Программное обеспечение системы`_.

.. _`Подсистема оперативного контроля`: /home/dmitrii/Elvoucher/docs/_build/html/program.html

* `Функциональная архитектура системы`_.

.. _`Основная информация о системе`: /home/dmitrii/Elvoucher/docs/_build/html/arch.html

* `Подсистема оперативного контроля`_.

.. _`Подсистема оперативного контроля`: /home/dmitrii/Elvoucher/docs/_build/html/POK.html

* `Подсистема информирования и доступа к информационным ресурсам`_.

.. _`Подсистема информирования и доступа к информационным ресурсам`: /home/dmitrii/Elvoucher/docs/_build/html/PODIR.html

* `Подсистема формирования отчетов`_.

.. _`Подсистема формирования отчетов`: /home/dmitrii/Elvoucher/docs/_build/html/POFO.html

* `Подсистема оперативной транзакционной обработки данных`_.

.. _`Подсистема оперативной транзакционной обработки данных`: /home/dmitrii/Elvoucher/docs/_build/html/POTOD.html

        * `Обмен данными с ИС туроператоров и турагентов`_.

.. _`Обмен данными с ИС туроператоров и турагентов`: /home/dmitrii/Elvoucher/docs/_build/html/touroperator.html

        * `Обмен данными с ЕФРТ`_.

.. _`Обмен данными с ЕФРТ`: /home/dmitrii/Elvoucher/docs/_build/html/EFRT.html
 
        * `Почтовое взаимодействие с внешними системами`_.

.. _`Почтовое взаимодействие с внешними системами`: /home/dmitrii/Elvoucher/docs/_build/html/mail.html
        
        * `Обмен данными с АИС Туризм`_.

.. _`Обмен данными с АИС Туризм`: /home/dmitrii/Elvoucher/docs/_build/html/AISTOUR.html

        * `Обмен данными с СИС Ростуризм`_.

.. _`Обмен данными с СИС Ростуризм`: /home/dmitrii/Elvoucher/docs/_build/html/SISROSTOUR.html
 
        * `Обмен данными с информационными системами банков и страховых компаний`_.

.. _`Обмен данными с информационными системами банков и страховых компаний`: /home/dmitrii/Elvoucher/docs/_build/html/fin.html

        * `Обмен данными с удостоверяющим центром`_.

.. _`Обмен данными с удостоверяющим центром`: /home/dmitrii/Elvoucher/docs/_build/html/UC.html

        * `Обмен данными с ЕСИА`_.

.. _`Обмен данными с ЕСИА`: /home/dmitrii/Elvoucher/docs/_build/html/ESIA.html
 
        * `Обмен данными с ЕГИС ОТБ`_.

.. _`Обмен данными с ЕГИС ОТБ`: /home/dmitrii/Elvoucher/docs/_build/html/EGISOTB.html

Обмен данными с удостоверяющим центром
=======================================================

В целях снижения затрат на организацию защищенного, юридически значимого электронного документооборота в ИС ЭП используются криптографические функции, связанные с созданием и проверкой электронной подписи, шифрованием и дешифрованием электронных документов. 

УЦ осуществляет свою деятельность в качестве аккредитованного УЦ на основании решения Минкомсвязи России, являющегося федеральным органом исполнительной власти, уполномоченным в сфере использования электронной подписи.

Электронная подпись создается с использованием криптографических алгоритмов в соответствии с ГОСТ Р 34.10 «Информационная технология. Криптографическая защита информации. Процессы формирования и проверки электронной цифровой подписи», ГОСТ Р 34.11-94 «Информационная технология. Криптографическая защита информации. Функция хеширования».

Данные об ЭП поступают от информационных систем ТО посредством протокола SOAP. Для подписания данных используется стандарт OASIS Standart 200401 (http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf). Получаемые от информационных систем ТО и подписанные заявки на создание/изменение ЭП должны быть подписаны электронной цифровой подписью (ЭЦП), а реализованное взаимодействие с УЦ позволяет обеспечить проверку и подтверждение отсутствия сертификата подписанта в реестре отозванных сертификатов УЦ. Сертификат используемой ЭЦП должен быть загружен в ИС ЭП при регистрации ИС ТО.

Заявки на самостоятельную регистрацию пользователя ТО должны быть подписаны ЭЦП, а реализованное взаимодействие с УЦ позволяет обеспечить проверку и подтверждение отсутствия сертификата подписанта в реестре отозванных сертификатов УЦ.

.. figure:: /home/dmitrii/Elvoucher/docs/_build/html/uc.png
              :align: center
       :alt: Алгоритм обработки подписанных ЭЦП сообщений
Алгоритм обработки подписанных ЭЦП сообщений

ЭП получает подписанный ЭЦП запрос от ТО:

* Xml-документ – при запросе ИС ТО;
* Pdf-документ – при самостоятельной регистрации администратора ТО.

Далее ИС ЭП выполняет следующий алгоритм: 

1) ИС ЭП получает сообщение, подписанное ЭЦП;

2) Сообщение, подписанное ЭЦП, проверяется с использованием встроенных средств программной платформы (Java 1.8), реализованной в подсистеме проверки электронной подписи;

3) С помощью СКЗИ происходит извлечение сертификата из подписанного сообщения. Для сообщений ИС ТО производится валидация – совпадение извлеченного сертификата с сертификатом, соответствующим данному ТО, загруженному в систему;

4) ИС ЭП получает список отозванных сертификатов УЦ по соответствующему адресу, указанному в извлеченном из сообщения сертификате; 

5) Список кэшируется в соответствующую таблицу для того, чтобы в дальнейшем минимизировать количество обращений в УЦ (время жизни кэша реестра отозванных сертификатов – 24 часа);

6) Сертификат, полученный из сообщения ТО, проверяется на предмет отсутствия в полученном реестре; 

7) В случае успешного прохождения проверок, приложение ИС ЭП возвращает положительный ответ;

8) ИС ЭП выполняет содержащийся в сообщении запрос и сохраняет в БД исходный запрос.
